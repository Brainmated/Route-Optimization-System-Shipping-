<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map with Information and Input Boxes</title>
</head>
<body>
    <div id="map" class="map-container">
        {{ map_html|safe }}
        {% if not simulation_run %}
        <div class="overlay">
            <div class="vessel-container">
                <div class="vessel">
                  <p class="vessel-label">Container Cargo Vessel</p>
                  <img src="{% static 'container.jpg' %}" alt="Container Cargo Vessel">
                </div>
                <span class="typewriter-text" data-text="Information about Container Cargo Vessel."></span>
              </div>
              <div class="vessel-container">
                <div class="vessel">
                  <p class="vessel-label">Ro Ro Container Vessel</p>
                  <img src="{% static 'ro ro.jpg' %}" alt="Ro Ro Container Vessel">
                </div>
                <span class="typewriter-text" data-text="Information about Ro Ro Vessel."></span>
              </div>
              <div class="vessel-container">
                <div class="vessel">
                  <p class="vessel-label">Crude Oil Tanker Vessel</p>
                  <img src="{% static 'tanker.jpg' %}" alt="Crude Oil Tanker Vessel">
                </div>
                <span class="typewriter-text" data-text="Information about Crude Oil Tanker Vessel."></span>
              </div>
          </div>
        <div id="input-box">
            <form method="post" action="{% url 'simulate' %}">
                {% csrf_token %}
                <div class="dropdown-container">
                    <label for="locationA">Location A:</label>
                    <select name="locationA" id="locationA">
                        <option value="">Select Location A</option>
                        {% for port in ports %}
                            <option value="{{ port.name }}">{{ port.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="dropdown-container">
                    <label for="locationB">Location B:</label>
                    <select name="locationB" id="locationB">
                        <option value="">Select Location B</option>
                        {% for port in ports %}
                            <option value="{{ port.name }}">{{ port.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <input type="number" name="weight" placeholder="Weight">
                <select name="propellerCondition" id="propellerCondition">
                    <option value="">Propeller Condition</option>
                </select>
                <input type="number" name="currentGasPrice" placeholder="Current Gas Price">
                <button type="submit" name="action" value="simulate">Simulate</button>
            </form>
        </div>
        {% endif %}
        {% if simulation_run %}
        <div id="info-box">
            Information
            <p>From {{ locationA }} to {{ locationB }}, the distance is {{ distance_km }} km.</p>
            <form action="{% url 'debug' %}" method="get">
                <button type="submit">Change/Modify Route</button>
            </form>
        </div>
        {% endif %}
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
          const vessels = document.querySelectorAll('.vessel');
      
          vessels.forEach(vessel => {
            const typewriterText = vessel.nextElementSibling;
            const text = typewriterText.getAttribute('data-text');
            let typewriterEffect;
      
            vessel.addEventListener('mouseenter', () => {
              // Clear existing intervals.
              clearInterval(typewriterEffect);
      
              let index = 0;
              typewriterText.textContent = '|'; // Show cursor
              typewriterText.style.visibility = 'visible'; // Make the text visible
      
              typewriterEffect = setInterval(() => {
                if (index < text.length) {
                  typewriterText.textContent = text.slice(0, index + 1) + '|';
                  index++;
                } else {
                  typewriterText.textContent = text; // Optionally remove the cursor at the end
                  clearInterval(typewriterEffect); // Stop typing effect when the text is complete
                }
              }, 100); // Typing speed in milliseconds
            });
      
            vessel.addEventListener('mouseleave', () => {
              clearInterval(typewriterEffect); // Clear interval when the mouse leaves the image.
              typewriterText.textContent = ''; // Clear the text.
              typewriterText.style.visibility = 'hidden'; // Hide the text again
            });
          });
        });
      </script>
</body>
</html>
